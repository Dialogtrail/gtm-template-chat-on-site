___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Dialogtrail - Chat on site",
  "categories": ["AFFILIATE_MARKETING", "ADVERTISING"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ4IDc5LjE2NDAzNiwgMjAxOS8wOC8xMy0wMTowNjo1NyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIxLjAgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcwQUFEN0QzMzg2RDExRUFBRTlCQTc0OEQ1N0JERDVGIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcwQUFEN0Q0Mzg2RDExRUFBRTlCQTc0OEQ1N0JERDVGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzBBQUQ3RDEzODZEMTFFQUFFOUJBNzQ4RDU3QkRENUYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzBBQUQ3RDIzODZEMTFFQUFFOUJBNzQ4RDU3QkRENUYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5ailxEAAAEY0lEQVR42rxZS0iUURQ+6qhYqIii5mshOo0PDGNKBFHH3CmFhhWZLgpK7QVuCmrpwqVQVibUorJ0UYJRLqTEhcqUjxApFfORTgqNG18446NzxjvyO977z/z/jPPBx8B/X999nXPPGZ/JyUlQAV/kKaQBqUdqkbHIo6x8FTmPHEd+R35FfkNuKx3IR6FAEnELeRmZoHCsP8gW5GPknJKVcAXhyEbkb+R9FeII8ch7SFqRJ8gITwm8gPyFrEEGgPugPqqRP5GX3BGoQT5Ftro6W4WgPt8inyH9lQo8gvyArILDxw3kezamSwI1bGbF4D0UszEDeGIcQbfsrKin8fFxGBgYgJmZGVhbW4OdnR1uPX9/fwgNDYWEhATQ6XSQkpLiTCSN+YitqNDMXES+E/XQ2toKfX19qpYoMjISDAYDZGdnO6tazszRAYHh7LZyL0RbWxv09va6vZfJyclQUVEBISEhoipm5HH2u+8M1onEzc7OekQcYWJiAurr6219ytjcOsdLQob3mqhFT0+PR28End2GhgZYWloSVbmKjJMKrJazRVNTUx6/ttvb29DY2ChnzG/abzGJvCLX2erqqrAsLy8PMjIyQKPZbxDW19fBZDLB4OAgzM3xXa/ZbIauri4oLCzkFZOmBxr2KomTdTe+fHtON7KkpETYjsxLQUEBdHd3Q3t7O7dOZ2cn5OfnH5gg03SaRi5w+uTx8eF+z8zMdGk7SUBpaSm3bHNzE4aHh0VNDSTwpNpzRJ27itzcXIiOjuaWjY6OiprpSaDOnYOuBFlZWdzvCwsLoiZaEnjMWw43JiaG+31lZUXYhAQGe0sg+Wcetra2RE2CfcGLEK2USLjdUC97SyC5OR5k/PIyCfzrDXF0oYxGo6KzSdpI4Jg3BDY3N8PGxga3LC0tTdRsjMz3IPK8mkFlDvcepqenoaOjA0ThbWBgIKSnp4uaD5DAL2pXJTY21vY7NDQE8/PzNsF2r2P3xfTylkNRUZHQlZI2EmhkgXScUoH9/f2wuLgIIyMjqiYYFRVl8zACUGbCqGHpiDcsqFYEeomoDo4DAqCmpkauymvS5isJlCzeMjdhYWFQW1trC6oEsLBMxl5UR1v8QhQHiyI3NdDr9VBWVma7HDJ4yXI5+8LOh8gyFhMceKK7levA7UxNTYWcnBxISkpyVt3MtByIi6ngDjuP+1BZWWlzU1ardc+W2X9pJejm0iTIGNtfOEFBQbYt1Gq1EBERIevOHHAX+U8u/daEvO5o72ibOa9e1aD+iDQ5yYO42XFsngG6jfwo/eDn56dInH1wufNLosj+ScR9gt3co9PcjIVlGD6rXR3pqojCBQd8Zuff4mp2i27FObbdh40mNtaa0vyglZmdcnsawsOgPssTExOrkFal+UEpWljc8txDxtzC+tJJk0TC46IwiR7PIv4KesYpFGZCvoLd/PSsy+fZjb8hKI92BnmCZaNiJPHNMhNEb80fsPs3BGWftpQO9F+AAQBNxliaRMuT0wAAAABJRU5ErkJggg\u003d\u003d"
  },
  "description": "Dialogtrail - Chat on site",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "id",
    "displayName": "Id",
    "simpleValueType": true,
    "help": "Configuration ID",
    "valueValidators": [
      {
        "type": "STRING_LENGTH",
        "args": [
          36,
          36
        ],
        "errorMessage": "Must be a valid ID"
      },
      {
        "type": "NON_EMPTY"
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Ange din mallkod här.
const log = require('logToConsole');
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');

log('data =', data);


const id = data.id;
const url = 'https://dialogtrail-prod.s3-eu-west-1.amazonaws.com/kiosk/widget.js?id=' + id;

// If the script loaded successfully, log a message and signal success
const onSuccess = () => {
  log('Dialogtrail - Chat on site: Script loaded successfully.');
  data.gtmOnSuccess();
};

// If the script fails to load, log a message and signal failure
const onFailure = () => {
  log('Dialogtrail - Chat on site: Script load failed.');
  data.gtmOnFailure();
};

if (queryPermission('inject_script', url)) {
  injectScript(url, onSuccess, onFailure);
} else {
  log('Dialogtrail - Chat on site: Script load failed due to permissions mismatch.');
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://dialogtrail-prod.s3-eu-west-1.amazonaws.com/"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 3/30/2021, 11:24:28 AM


